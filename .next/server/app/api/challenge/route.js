"use strict";(()=>{var e={};e.id=631,e.ids=[631],e.modules={20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},64261:(e,r,t)=>{t.r(r),t.d(r,{originalPathname:()=>w,patchFetch:()=>y,requestAsyncStorage:()=>h,routeModule:()=>g,serverHooks:()=>f,staticGenerationAsyncStorage:()=>m});var n={};t.r(n),t.d(n,{GET:()=>d,POST:()=>l,PUT:()=>p});var s=t(49303),a=t(88716),i=t(60670),o=t(87070),c=t(43949),u=t(96094);async function l(e){try{let{creatorId:r,title:t,description:n,image:s,tags:a,startDate:i,endDate:u,isBranded:l,brandName:d,prize:p}=await e.json();if(!r||!t||!n||!i||!u)return o.NextResponse.json({error:"Missing required fields"},{status:400});let g=await c._.challenge.create({data:{creatorId:r,title:t,description:n,image:s,tags:a||[],startDate:new Date(i),endDate:new Date(u),isBranded:l||!1,brandName:d,prize:p}});return o.NextResponse.json({success:!0,challenge:g})}catch(e){return console.error("Error creating challenge:",e),o.NextResponse.json({error:"Internal server error"},{status:500})}}async function d(e){try{let r;let{searchParams:t}=new URL(e.url),n=t.get("userId");switch(t.get("type")||"active"){case"my-challenges":if(!n)return o.NextResponse.json({error:"User ID required for my-challenges"},{status:400});r=await c._.challenge.findMany({where:{creatorId:n},include:{creator:{select:{id:!0,name:!0,username:!0,image:!0}},entries:{include:{user:{select:{id:!0,name:!0,username:!0,image:!0}}}},_count:{select:{entries:!0,posts:!0}}},orderBy:{createdAt:"desc"}});break;case"ended":r=await c._.challenge.findMany({where:{endDate:{lt:new Date},isActive:!0},include:{creator:{select:{id:!0,name:!0,username:!0,image:!0}},entries:{include:{user:{select:{id:!0,name:!0,username:!0,image:!0}}}},_count:{select:{entries:!0,posts:!0}}},orderBy:{endDate:"desc"}});break;default:r=await c._.challenge.findMany({where:{startDate:{lte:new Date},endDate:{gt:new Date},isActive:!0},include:{creator:{select:{id:!0,name:!0,username:!0,image:!0}},entries:{include:{user:{select:{id:!0,name:!0,username:!0,image:!0}}}},_count:{select:{entries:!0,posts:!0}}},orderBy:{startDate:"desc"}})}return n&&(r=r.map(e=>({...e,isParticipating:e.entries.some(e=>e.userId===n),userEntry:e.entries.find(e=>e.userId===n)}))),o.NextResponse.json({challenges:r})}catch(e){return console.error("Error fetching challenges:",e),o.NextResponse.json({error:"Internal server error"},{status:500})}}async function p(e){try{let{challengeId:r,userId:t,postId:n,score:s}=await e.json();if(!r||!t)return o.NextResponse.json({error:"Challenge ID and User ID are required"},{status:400});let a=await c._.challengeEntry.upsert({where:{challengeId_userId:{challengeId:r,userId:t}},update:{postId:n,score:s},create:{challengeId:r,userId:t,postId:n,score:s}});return await c._.user.update({where:{id:t},data:{xp:{increment:(0,u.b4)("challenge")}}}),o.NextResponse.json({success:!0,entry:a})}catch(e){return console.error("Error updating challenge entry:",e),o.NextResponse.json({error:"Internal server error"},{status:500})}}let g=new s.AppRouteRouteModule({definition:{kind:a.x.APP_ROUTE,page:"/api/challenge/route",pathname:"/api/challenge",filename:"route",bundlePath:"app/api/challenge/route"},resolvedPagePath:"/Users/ronak/Downloads/fitzy_01/Fitzty/src/app/api/challenge/route.ts",nextConfigOutput:"",userland:n}),{requestAsyncStorage:h,staticGenerationAsyncStorage:m,serverHooks:f}=g,w="/api/challenge/route";function y(){return(0,i.patchFetch)({serverHooks:f,staticGenerationAsyncStorage:m})}},96094:(e,r,t)=>{function n(e){return({post:20,upvote:5,streak:10,challenge:50,comment:3})[e]}function s(e){return Math.floor(e/100)+1}function a(e){let r=[];return e>=500&&r.push("Hairstyle: Wave Cut"),e>=1e3&&r.push("Background: Rooftop NYC"),e>=1500&&r.push("Clothing: Designer Jacket"),e>=2e3&&r.push("Accessory: Gold Chain"),e>=3e3&&r.push("Pose: Dancing"),r}t.d(r,{IN:()=>s,Rl:()=>a,b4:()=>n})},43949:(e,r,t)=>{t.d(r,{_:()=>s});let n=require("@prisma/client"),s=globalThis.prisma??new n.PrismaClient}};var r=require("../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),n=r.X(0,[276,972],()=>t(64261));module.exports=n})();