(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[826],{5454:function(e,t,s){Promise.resolve().then(s.bind(s,2105))},2105:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return _}});var r=s(7437),a=s(2265),n=s(605),i=s(3145),l=s(4930),o=s(3448);let c=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)(l.fC,{ref:t,className:(0,o.cn)("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",s),...a})});c.displayName=l.fC.displayName;let d=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)(l.Ee,{ref:t,className:(0,o.cn)("aspect-square h-full w-full",s),...a})});d.displayName=l.Ee.displayName;let u=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)(l.NY,{ref:t,className:(0,o.cn)("flex h-full w-full items-center justify-center rounded-full bg-muted",s),...a})});u.displayName=l.NY.displayName;var f=s(2381),h=s(9820),m=s(9174),x=s(7782),v=s(8997),g=s(2718),p=s(8919),b=s(1178),j=s(1448);class y{setupLighting(){let e=new j.Mig(16777215,.6);this.scene.add(e);let t=new j.Ox3(16777215,.8);t.position.set(10,10,5),this.scene.add(t)}async createAvatar(e){this.avatarMesh&&this.scene.remove(this.avatarMesh),this.avatarMesh=new j.ZAu,await this.createBody(e),await this.createHair(e),await this.createClothing(e),await this.createAccessories(e),this.scene.add(this.avatarMesh),this.animate()}async createBody(e){var t;let s=new j.fHI(.5,.6,2,8),r=new j.YBo({color:this.getSkinToneColor(e.skinTone)}),a=new j.Kj0(s,r);a.position.y=0,null===(t=this.avatarMesh)||void 0===t||t.add(a)}async createHair(e){var t;let s=new j.xo$(.6,8,6),r=new j.YBo({color:this.getHairColor(e.hairColor)}),a=new j.Kj0(s,r);a.position.y=1.2,a.scale.y=.8,null===(t=this.avatarMesh)||void 0===t||t.add(a)}async createClothing(e){var t,s;if(e.clothing.top){let e=new j.fHI(.6,.7,1,8),s=new j.YBo({color:3368652}),r=new j.Kj0(e,s);r.position.y=.5,null===(t=this.avatarMesh)||void 0===t||t.add(r)}if(e.clothing.bottom){let e=new j.fHI(.7,.5,1,8),t=new j.YBo({color:3355443}),r=new j.Kj0(e,t);r.position.y=-.5,null===(s=this.avatarMesh)||void 0===s||s.add(r)}}async createAccessories(e){e.clothing.accessories.forEach((e,t)=>{var s;let r=new j.DvJ(.1,.1,.1),a=new j.YBo({color:16766720}),n=new j.Kj0(r,a);n.position.set(.3+.2*t,1.1,0),null===(s=this.avatarMesh)||void 0===s||s.add(n)})}getSkinToneColor(e){let t={light:16767916,medium:15843965,dark:14724201,deep:13010498,rich:9262372};return t[e]||t.medium}getHairColor(e){let t={black:0,brown:9127187,blonde:16766720,red:16729344,gray:8421504};return t[e]||t.brown}animate(){requestAnimationFrame(()=>this.animate()),this.avatarMesh&&(this.avatarMesh.rotation.y+=.01),this.renderer.render(this.scene,this.camera)}setPose(e){if(this.avatarMesh)switch(this.avatarMesh.rotation.set(0,0,0),e){case"sitting":this.avatarMesh.scale.y=.8;break;case"walking":this.avatarMesh.rotation.z=.1*Math.sin(.01*Date.now());break;case"dancing":this.avatarMesh.rotation.z=.2*Math.sin(.02*Date.now());break;default:this.avatarMesh.scale.set(1,1,1)}}resize(e,t){this.camera.aspect=e/t,this.camera.updateProjectionMatrix(),this.renderer.setSize(e,t)}dispose(){this.renderer.dispose()}constructor(e){this.scene=new j.xsS,this.camera=new j.cPb(75,e.clientWidth/e.clientHeight,.1,1e3),this.renderer=new j.CP7({alpha:!0,antialias:!0}),this.renderer.setSize(e.clientWidth,e.clientHeight),this.renderer.setClearColor(0,0),e.appendChild(this.renderer.domElement),this.setupLighting(),this.camera.position.z=5}}function N(e){let{config:t,className:s,pose:n="standing"}=e,i=(0,a.useRef)(null),l=(0,a.useRef)(null);return((0,a.useEffect)(()=>{if(i.current&&t)return l.current=new y(i.current),l.current.createAvatar(t),()=>{var e;null===(e=l.current)||void 0===e||e.dispose()}},[t]),(0,a.useEffect)(()=>{l.current&&n&&l.current.setPose(n)},[n]),t)?(0,r.jsx)("div",{ref:i,className:(0,o.cn)("w-full h-full",s)}):(0,r.jsx)("div",{className:(0,o.cn)("bg-muted rounded-full flex items-center justify-center",s),children:(0,r.jsx)("div",{className:"w-16 h-16 bg-primary/20 rounded-full flex items-center justify-center",children:(0,r.jsx)("span",{className:"text-2xl",children:"\uD83D\uDC64"})})})}function w(e){var t,s;let{post:n,onLike:l,onSave:o,currentUserId:j}=e,[y,w]=(0,a.useState)(0),[k,C]=(0,a.useState)(!1);return(0,r.jsx)(h.Zb,{className:"mb-4 border-0 shadow-none",children:(0,r.jsxs)(h.aY,{className:"p-0",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between p-4 pb-2",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,r.jsxs)(c,{className:"h-10 w-10",children:[(0,r.jsx)(d,{src:n.user.image||""}),(0,r.jsx)(u,{children:(null===(t=n.user.name)||void 0===t?void 0:t.charAt(0))||(null===(s=n.user.username)||void 0===s?void 0:s.charAt(0))||"U"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"font-semibold text-sm",children:n.user.name||n.user.username||"Anonymous"}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground",children:(e=>{let t=new Date(e),s=Math.floor((new Date().getTime()-t.getTime())/36e5);return s<1?"Just now":s<24?"".concat(s,"h ago"):s<48?"Yesterday":t.toLocaleDateString()})(n.createdAt)})]})]}),(0,r.jsx)(f.z,{variant:"ghost",size:"sm",children:(0,r.jsx)(x.Z,{className:"h-4 w-4"})})]}),n.content&&(0,r.jsx)("div",{className:"px-4 pb-2",children:(0,r.jsx)("p",{className:"text-sm",children:n.content})}),n.tags.length>0&&(0,r.jsxs)("div",{className:"px-4 pb-2 flex flex-wrap gap-1",children:[n.tags.slice(0,3).map(e=>(0,r.jsxs)(m.C,{variant:"secondary",className:"text-xs",children:["#",e]},e)),n.tags.length>3&&(0,r.jsxs)(m.C,{variant:"secondary",className:"text-xs",children:["+",n.tags.length-3," more"]})]}),(0,r.jsx)("div",{className:"relative aspect-square bg-muted",children:k&&n.avatarImage?(0,r.jsx)("div",{className:"w-full h-full flex items-center justify-center",children:(0,r.jsx)(N,{config:n.user.avatarConfig,className:"w-full h-full"})}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(i.default,{src:n.images[y]||"/placeholder.svg",alt:"Post image",fill:!0,className:"object-cover cursor-pointer",onClick:()=>{n.avatarImage&&C(!k)}}),n.images.length>1&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(f.z,{variant:"ghost",size:"sm",className:"absolute left-2 top-1/2 transform -translate-y-1/2 bg-black/50 text-white hover:bg-black/70",onClick:()=>{n.images.length>1&&w(e=>(e-1+n.images.length)%n.images.length)},children:"‹"}),(0,r.jsx)(f.z,{variant:"ghost",size:"sm",className:"absolute right-2 top-1/2 transform -translate-y-1/2 bg-black/50 text-white hover:bg-black/70",onClick:()=>{n.images.length>1&&w(e=>(e+1)%n.images.length)},children:"›"}),(0,r.jsx)("div",{className:"absolute bottom-2 left-1/2 transform -translate-x-1/2 flex space-x-1",children:n.images.map((e,t)=>(0,r.jsx)("div",{className:"w-2 h-2 rounded-full ".concat(t===y?"bg-white":"bg-white/50")},t))})]})]})}),(0,r.jsxs)("div",{className:"flex items-center justify-between p-4 pt-2",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,r.jsxs)(f.z,{variant:"ghost",size:"sm",onClick:()=>l(n.id),className:"flex items-center space-x-1 ".concat(n.isLiked?"text-red-500":"text-muted-foreground"),children:[(0,r.jsx)(v.Z,{className:"h-5 w-5 ".concat(n.isLiked?"fill-current":"")}),(0,r.jsx)("span",{className:"text-sm",children:n._count.likes})]}),(0,r.jsxs)(f.z,{variant:"ghost",size:"sm",className:"flex items-center space-x-1",children:[(0,r.jsx)(g.Z,{className:"h-5 w-5"}),(0,r.jsx)("span",{className:"text-sm",children:n._count.comments})]}),(0,r.jsx)(f.z,{variant:"ghost",size:"sm",children:(0,r.jsx)(p.Z,{className:"h-5 w-5"})})]}),(0,r.jsx)(f.z,{variant:"ghost",size:"sm",onClick:()=>o(n.id),className:n.isSaved?"text-blue-500":"text-muted-foreground",children:(0,r.jsx)(b.Z,{className:"h-5 w-5 ".concat(n.isSaved?"fill-current":"")})})]}),(n.style||n.brand||n.color||n.price)&&(0,r.jsx)("div",{className:"px-4 pb-4",children:(0,r.jsxs)("div",{className:"flex flex-wrap gap-2 text-xs text-muted-foreground",children:[n.style&&(0,r.jsxs)("span",{children:["Style: ",n.style]}),n.brand&&(0,r.jsxs)("span",{children:["Brand: ",n.brand]}),n.color&&(0,r.jsxs)("span",{children:["Color: ",n.color]}),n.price&&(0,r.jsxs)("span",{children:["Price: ",n.price]})]})})]})})}var k=s(7168);function C(e){let{activeTab:t,onTabChange:s}=e;return(0,r.jsx)("div",{className:"px-4 pb-2",children:(0,r.jsx)(k.mQ,{value:t,onValueChange:e=>s(e),children:(0,r.jsxs)(k.dr,{className:"grid w-full grid-cols-3",children:[(0,r.jsx)(k.SP,{value:"fyp",className:"text-xs",children:"For You"}),(0,r.jsx)(k.SP,{value:"friends",className:"text-xs",children:"Friends"}),(0,r.jsx)(k.SP,{value:"trending",className:"text-xs",children:"Trending"})]})})})}var z=s(1817);function S(e){let{className:t,size:s=24}=e;return(0,r.jsx)(z.Z,{className:(0,o.cn)("animate-spin",t),size:s})}var M=s(6744);function _(){let{data:e}=(0,n.useSession)(),[t,s]=(0,a.useState)([]),[i,l]=(0,a.useState)(!0),[o,c]=(0,a.useState)(!0),[d,u]=(0,a.useState)(1),[h,m]=(0,a.useState)("fyp"),[x,v]=(0,a.useState)(!1),g=async function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(null==e?void 0:e.user)try{var a;l(!0);let n=await fetch("/api/feed?userId=".concat((null===(a=e.user)||void 0===a?void 0:a.email)||"mock-user","&type=").concat(h,"&page=").concat(t,"&limit=10")),i=await n.json();r?s(i.posts):s(e=>[...e,...i.posts]),c(i.hasMore),u(i.nextPage)}catch(e){console.error("Error fetching posts:",e)}finally{l(!1),v(!1)}};(0,a.useEffect)(()=>{(null==e?void 0:e.user)&&(s([]),u(1),c(!0),g(1,!0))},[null==e?void 0:e.user,h]);let p=async t=>{if(null==e?void 0:e.user)try{(await fetch("/api/posts/like",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({postId:t,userId:e.user.email||"mock-user"})})).ok&&s(e=>e.map(e=>e.id===t?{...e,isLiked:!e.isLiked,_count:{...e._count,likes:e.isLiked?e._count.likes-1:e._count.likes+1}}:e))}catch(e){console.error("Error liking post:",e)}},b=async t=>{if(null==e?void 0:e.user)try{(await fetch("/api/posts/save",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({postId:t,userId:e.user.email||"mock-user"})})).ok&&s(e=>e.map(e=>e.id===t?{...e,isSaved:!e.isSaved,_count:{...e._count,saves:e.isSaved?e._count.saves-1:e._count.saves+1}}:e))}catch(e){console.error("Error saving post:",e)}};return e?(0,r.jsx)("div",{className:"min-h-screen bg-background",children:(0,r.jsxs)("div",{className:"max-w-md mx-auto",children:[(0,r.jsxs)("div",{className:"sticky top-0 z-10 bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60 border-b",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between p-4",children:[(0,r.jsx)("h1",{className:"text-xl font-bold",children:"Fitzty"}),(0,r.jsx)(f.z,{variant:"ghost",size:"sm",onClick:()=>{v(!0),s([]),u(1),c(!0),g(1,!0)},disabled:x,children:(0,r.jsx)(M.Z,{className:"h-4 w-4 ".concat(x?"animate-spin":"")})})]}),(0,r.jsx)(C,{activeTab:h,onTabChange:m})]}),(0,r.jsxs)("div",{className:"pb-20",children:[t.map(t=>{var s;return(0,r.jsx)(w,{post:t,onLike:p,onSave:b,currentUserId:(null===(s=e.user)||void 0===s?void 0:s.email)||"mock-user"},t.id)}),i&&(0,r.jsx)("div",{className:"flex justify-center p-8",children:(0,r.jsx)(S,{})}),!i&&o&&(0,r.jsx)("div",{className:"flex justify-center p-4",children:(0,r.jsx)(f.z,{onClick:()=>{!i&&o&&g(d)},variant:"outline",children:"Load More"})}),!i&&!o&&t.length>0&&(0,r.jsx)("div",{className:"text-center p-8 text-muted-foreground",children:"You've reached the end of your feed!"}),!i&&0===t.length&&(0,r.jsxs)("div",{className:"text-center p-8",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"No posts yet"}),(0,r.jsx)("p",{className:"text-muted-foreground",children:"Follow some users or create your first post to see content here!"})]})]})]})}):(0,r.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("h2",{className:"text-2xl font-bold mb-4",children:"Sign in to view your feed"}),(0,r.jsx)("p",{className:"text-muted-foreground",children:"Join Fitzty to discover amazing fashion content"})]})})}},9174:function(e,t,s){"use strict";s.d(t,{C:function(){return l}});var r=s(7437);s(2265);var a=s(535),n=s(3448);let i=(0,a.j)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function l(e){let{className:t,variant:s,...a}=e;return(0,r.jsx)("div",{className:(0,n.cn)(i({variant:s}),t),...a})}},2381:function(e,t,s){"use strict";s.d(t,{z:function(){return c}});var r=s(7437),a=s(2265),n=s(7495),i=s(535),l=s(3448);let o=(0,i.j)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),c=a.forwardRef((e,t)=>{let{className:s,variant:a,size:i,asChild:c=!1,...d}=e,u=c?n.g7:"button";return(0,r.jsx)(u,{className:(0,l.cn)(o({variant:a,size:i,className:s})),ref:t,...d})});c.displayName="Button"},9820:function(e,t,s){"use strict";s.d(t,{Ol:function(){return l},SZ:function(){return c},Zb:function(){return i},aY:function(){return d},ll:function(){return o}});var r=s(7437),a=s(2265),n=s(3448);let i=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("div",{ref:t,className:(0,n.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",s),...a})});i.displayName="Card";let l=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("div",{ref:t,className:(0,n.cn)("flex flex-col space-y-1.5 p-6",s),...a})});l.displayName="CardHeader";let o=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("h3",{ref:t,className:(0,n.cn)("text-2xl font-semibold leading-none tracking-tight",s),...a})});o.displayName="CardTitle";let c=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("p",{ref:t,className:(0,n.cn)("text-sm text-muted-foreground",s),...a})});c.displayName="CardDescription";let d=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("div",{ref:t,className:(0,n.cn)("p-6 pt-0",s),...a})});d.displayName="CardContent",a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("div",{ref:t,className:(0,n.cn)("flex items-center p-6 pt-0",s),...a})}).displayName="CardFooter"},7168:function(e,t,s){"use strict";s.d(t,{SP:function(){return c},dr:function(){return o},mQ:function(){return l},nU:function(){return d}});var r=s(7437),a=s(2265),n=s(200),i=s(3448);let l=n.fC,o=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)(n.aV,{ref:t,className:(0,i.cn)("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",s),...a})});o.displayName=n.aV.displayName;let c=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)(n.xz,{ref:t,className:(0,i.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",s),...a})});c.displayName=n.xz.displayName;let d=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)(n.VY,{ref:t,className:(0,i.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",s),...a})});d.displayName=n.VY.displayName},3448:function(e,t,s){"use strict";s.d(t,{cn:function(){return n}});var r=s(1994),a=s(3335);function n(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return(0,a.m6)((0,r.W)(t))}}},function(e){e.O(0,[689,203,200,472,41,971,117,744],function(){return e(e.s=5454)}),_N_E=e.O()}]);